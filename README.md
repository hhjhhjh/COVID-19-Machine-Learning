# COVID-19-Machine-Learning

본 프로젝트는 Kaggle의 [COVID-19 Dataset](https://www.kaggle.com/datasets/meirnizri/covid19-dataset)을 활용하여 환자의 사망 여부를 예측하는 이진 분류 모델을 구축한 결과물입니다. 기존 Kaggle 분석의 한계를 보완하여, 데이터 불균형 문제와 임계값 조정의 효과를 종합적으로 검토하였습니다.

---

## 📌 연구 배경
- 기존 Kaggle 보고서에서는 `CLASIFFICATION_FINAL` 변수(코로나 확진 여부)를 포함하여 모델 성능이 과대평가될 가능성이 있었습니다.
- 또한 **로지스틱 회귀 단일 알고리즘**과 **언더샘플링만**을 사용해, 다양한 불균형 대응/모델 비교/임계값 최적화의 효과는 검토되지 않았습니다.

---

## 🚀 이번 프로젝트의 개선점 (What’s new)
- **시나리오 분리**: 전체 환자 vs. 확진자만(양성) 코호트 별도로 설계
- **모델 다변화**: 로지스틱 회귀 ↔ **LightGBM** 비교로 선형/비선형 성능 검증
- **불균형 대응 비교**: 언더샘플링 + **오버샘플링** 모두 실험
- **임계값 최적화**: 0.5 고정 대비, **검증셋 기반 최적 임계값**으로 F1/Precision 개선 확인
- **평가지표 확장**: ACC 의존 탈피 → **ROC-AUC, PR-AUC, Precision, Recall, F1, 혼동행렬** 병행

---

## 📊 데이터셋
- 출처: Kaggle COVID-19 Dataset (멕시코 보건부 공개 데이터)
- 주요 변수: AGE, SEX, 기저질환(고혈압, 당뇨, 비만 등), 생활습관(흡연), 코로나 확진 여부(`CLASIFFICATION_FINAL`), 사망 여부(DEATH)
- 전처리:
  - 결측·특수 코드(97/98/99) 처리
  - `PREGNANT_CLEAN` 생성 (남성은 2로 변환)
  - `INTUBED`, `ICU` 등 내생 변수 제외
  - 범주형 → 원-핫 인코딩, AGE → 표준화

---

## ⚙️ 방법론
1. **시나리오 설계**
   - 전체 환자 (코로나 변수 포함/제외 비교)
   - 확진자만 (코로나 변수 제거)
   - 불균형 대응 (언더샘플링, 오버샘플링)
2. **모델링**
   - Logistic Regression (해석력 중심)
   - **LightGBM** (비선형 성능 중심)
3. **평가 지표**
   - ROC-AUC, PR-AUC, Precision, Recall, F1-score, Confusion Matrix
   - 임계값: 0.5 vs 검증셋 기반 최적값

---

## 📈 주요 결과
- **LightGBM**이 ROC-AUC와 PR-AUC에서 일관되게 우수
- 임계값 최적화 시 **Precision·F1 ↑, Recall ↓** (FP 감소·FN 증가 → 보수적 예측)
- 리샘플링 효과는 제한적 (언더/오버 모두 성능 변화 미미)
- 확진자 코호트 분석 시, 코로나 변수 영향 제거 → 환자 특성 반영 경향 확인

---

## 🔍 결론 및 시사점
- 단순 정확도(Accuracy)만으로는 불균형 데이터 평가에 한계 → **다양한 지표** 필요
- **임계값 조정**이 리샘플링보다 더 큰 실질적 개선 제공
- 실제 의료 적용에서는 **Recall 우선**(사망자 누락 최소화) vs **Precision 우선**(불필요 경고 최소화) 정책 선택이 중요

---

✍️ Author: Jeonghyun Hwang (황정현)  
📅 Course Project: 통계데이터사이언스
